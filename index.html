<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Typing Master</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>

.gradient-border-wrapper {
    position: relative;
    display: inline-block;
    padding: 5px;
    border-radius: 9999px;

    background: transparent;
    overflow: hidden;
}

.border-wrapper {
    position: relative;
    display: flex;
    padding: 3px;
    border-radius: 10px;
    background: transparent;
    overflow: hidden;
}



.gradient-border-wrapper::before {
    content: "";
    position: absolute;
    right: -17px;
    top: -38px;
    insert: -50%;
    width: 150px;
    height: 150px;
    background: conic-gradient(
        #4285f4,
        #ea4335,
        #fbbc05,
        #34a853,
        #4285f4
    );
    animation: google-ring-spin 3s linear infinite;
}


.border-wrapper::before {
    content: "";
    position: absolute;
    right: -15%;
    top: -470px;
    insert: -50%;
    width: 130%;
    height: 700%;
    background: conic-gradient(
        #4285f4,
        #ea4335,
        #fbbc05,
        #34a853,
        #4285f4
    );
    animation: google-ring-spin 3s linear infinite;
}
.gradient-border-wrapper .inner-button {
    position: relative;
    z-index: 1;
    border: none;
    border-radius: 999px;
    padding: 10px 26px;
    background: #111;
    color: #fff;
    font-size: 1rem;
    cursor: pointer;
}


@keyframes google-ring-spin {
    0%   { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}


.border-wrapper .inner-button {
    position: relative;
    z-index: 1;
    border: none;
    border-radius: 10px;
    padding: 60px 440px;
    background: #D1FFFF;
    color: black;
    font-size: 1rem;
    cursor: pointer;
}


@keyframes google-ring-spin {
    0%   { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}


            body {
            font-family: 'Poppins', sans-serif;
            background-color: #424242;
            color: #333;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }



/* ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

 .glow header {
            width: 85%;
            z-index: 2;
            text-align: center;
            border-radius: 12px;
            padding: 20px 0;
            background-color: #007bff;
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 { margin: 0; font-weight: 600; }

.glow {
    position: relative;
    display: inline-block;
    padding: 5px;
    border-radius: 9999px;

    background: transparent;
    overflow: hidden;
}

.glow::before {
    content: "";
    position: absolute;
    right: -670px;
    top: -190px;
    insert: -50%;
    width: 2700px;
    height: 2700px;
    background: conic-gradient(
        #4285f4,
        #ea4335,
        #fbbc05,
        #34a853,
        #4285f4
    );
    animation: google-ring-spin 3s linear infinite;
}
  .glow {
            display: flex;
            flex-direction: column;
            width: 100%;
            justify-content: center;
            align-items: center;
            margin-top: 0px;
            padding: 0px;
            background-color: red;
            border-radius: 0px;
            position: relative;
        }



        .container {
            width: 90%;
            max-width: 1100px;
            margin-top: 30px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #E3E3E3;
            border-radius: 12px;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            position: relative;
        }
/* ------------------------------------------------------------------------------------------------------------------------------------*/
        .stats-panel {
            display: flex;
            justify-content: space-around;
            background-color: #BDBDBD;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 1.1em;
            font-weight: 500;
            border-left: 5px solid #007bff;
        }
        .stats-panel p { margin: 0; }
        .stats-panel span { font-weight: 700; color: #d9534f; }
        #net-wpm, #accuracy { color: #5cb85c; }


        .graph-container {
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 20px;
            height: 350px;
            background-color: #BDBDBD;
        }


        .typing-text-display {
            background-color: #ADFF5C;
            padding: 25px;
            border-radius: 8px;
            font-size: 1.4em;
            line-height: 1.8;
            margin-bottom: 20px;
            min-height: 120px;
            border: 2px solid #ccc;
            user-select: none;
        }


        .correct { color: #5cb85c; }
        .incorrect {
            background-color: #f2dede;
            color: #a94442;
            border-bottom: 1px dashed #a94442;
        }
        .current {
            background-color: #007bff40;
            border-right: 2px solid #007bff;
            animation: blink 1s step-start 0s infinite;
        }
        @keyframes blink { 50% { border-right-color: transparent; } }


        .text-input {
            width: 5%;
            height: 100px;
            padding: 15px;
            border: 2px solid #007bff;
            border-radius: 8px;
            font-size: 1.4em;
            resize: none;
            background-color: #BDBDBD;
            color: #333;
            box-sizing: border-box;
            outline: none;
            margin-bottom: 20px;
            transition: box-shadow 0.3s;
        }
        .text-input:focus { box-shadow: 0 0 10px rgba(0, 123, 255, 0.5); }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .controls select, .controls input[type="number"] {
            padding: 10px 18px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 1em;
            background-color: #BDBDBD;
            color: #333;
        }


        .loading-text { color: #007bff; font-style: italic; }


        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .popup-content {
            background: white;
            padding: 0px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.5);
            max-width: 90%;
            width: 746px;
            height: 430px;
            position: relative;
            overflow:hidden;
            transform: scale(0.9);
            transition: transform 0.3s ease-out;
        }
        .popup-content.show {
            transform: scale(1);
        }


        .popup-content h2 { color: #d9534f; font-size: 2.5em; margin-top: 0; }
        .popup-content .result-stats p { font-size: 1.2em; font-weight: 500; }
        .popup-content .result-stats span { font-weight: 700; color: #007bff; }
        .popup-content img { width: 80px; height: 80px; margin-bottom: 20px; }


        .countdown-number {
            font-size: 10em;
            font-weight: 900;
            color: #5cb85c;
            animation: pulse 1s ease-in-out infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 0.8; }
        }

        .popup-controls {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .popup-controls button {
            background-color: #5cb85c;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .popup-controls button:hover {
            background-color: #449d44;
        }
        .popup-time-select {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }
        .popup-time-select select, .popup-time-select input {
             padding: 8px;
             border: 1px solid #ced4da;
             border-radius: 5px;
        }
    </style>
</head>
<body>



    <main class="glow" style="colour: blue;">

    <header>
        <h1>Typing Trainer Pro</h1>
    </header>

<div class="container">
        <div class="stats-panel">
            <p>Net Speed: <span id="net-wpm">0</span> WPM</p>
            <p>Accuracy: <span id="accuracy">100</span>%</p>
            <p>Errors: <span id="errors-count">0</span></p>
            <p>Time Left: <span id="time-left">60</span>s</p>
        </div>

        <div class="graph-container">
            <h3>WPM Consistency (Per 5 seconds)</h3>
            <canvas id="wpm-chart"></canvas>
        </div>

        <div id="initial-controls" class="controls">
            <select id="time-select">
                <option value="60">1 Minute</option>
                <option value="180">3 Minutes</option>
                <option value="300">5 Minutes</option>
                </select>
            <input type="number" id="custom-time" min="10" max="600" value="60" placeholder="Custom Time (s)">

            <select id="lesson-mode">
                <option value="news">Dynamic News (Recommended)</option>
                <option value="standard">Static Paragraph</option>
                <option value="code">Code Syntax</option>
            </select>
     <div class="gradient-border-wrapper">
  <button <button id="initial-start-btn" class="inner-button" style="background-color: black;
   ">Start Test</button> </div>


</div>
        <div id="typing-text-display" class="typing-text-display loading-text">
            Loading Fresh Content... Please wait.
        </div>




<div class="border-wrapper">
        <textarea id="text-input" class="inner-button" style="colour: #D1FFFF;" placeholder="Type here when the countdown finishes..." autofocus enhanced>
        </textarea>
</div> </div>
    </main>

    <div id="popup-overlay" class="popup-overlay">
        <div id="popup-content" class="popup-content">
            </div>
    </div>

    <script>
        // --- Global State ---
        let state = {
            testText: "",
            currentCharIndex: 0,
            totalErrors: 0,
            correctKeystrokes: 0,
            incorrectKeystrokes: 0,
            timerId: null,
            initialTime: 60,
            timeLeft: 60,
            isRunning: false,
            wpmHistory: [],
            historyLabels: [],
            timeElapsed: 0,
        };

        // --- DOM Elements ---
        const textDisplay = document.getElementById('typing-text-display');
        const textInput = document.getElementById('text-input');
        const modeSelect = document.getElementById('lesson-mode');
        const timeSelect = document.getElementById('time-select');
        const customTimeInput = document.getElementById('custom-time');
        const netWpmEl = document.getElementById('net-wpm');
        const accuracyEl = document.getElementById('accuracy');
        const errorsCountEl = document.getElementById('errors-count');
        const timeLeftEl = document.getElementById('time-left');
        const popupOverlay = document.getElementById('popup-overlay');
        const popupContent = document.getElementById('popup-content');
        const initialStartBtn = document.getElementById('initial-start-btn');

        // Static Text Bank

        // Simulated Dynamic Content (Shows different content each time)
        // Static Text Bank
const textBank = {
    standard: "A journey of a thousand miles begins with a single step. The only way to do great work is to love what you do. Success is not final, failure is not fatal: it is the courage to continue that counts.",
    code: "function fetchData(url) { return fetch(url).then(response => response.json()).catch(error => console.error('Error fetching:', error)); }",
};

// --- NEW Static Content Pool (No internet fetch required) ---
// Ab aapka 'news' mode is bade array se paragraphs chune ga.
const newsBank = [
    "Global leaders convened at the UN Climate Summit, committing to ambitious new targets for reducing greenhouse gas emissions by 2035, focusing heavily on transitioning from coal to renewable energy sources.",
    "A major pharmaceutical breakthrough was announced today, involving a novel compound that shows promising results in early-stage trials for reversing certain types of age-related cognitive decline.",
    "The International Space Agency successfully deployed the next generation of deep-space telescopes, which are expected to provide unprecedented views into the formation of early galaxies and exoplanets.",
    "Stock markets across Asia experienced volatility this week following unexpected inflation data released by the regional central bank, leading to cautious trading in technology and consumer goods sectors.",
    "Archaeologists in Egypt unearthed a remarkably well-preserved tomb dating back over 4,000 years, offering new insights into the burial rituals and social hierarchy of the Old Kingdom period.",
    "Tech giants are facing increased regulatory scrutiny in Europe over data privacy and monopolistic practices, suggesting potential large-scale restructuring of digital advertising and search market dominance.",
    "A new report highlights a significant global shift towards remote work, predicting that over 30% of high-skilled professional jobs will permanently transition out of traditional office environments by next year.",
    "Massive forest fires in the Amazon region continue to challenge conservation efforts, prompting international calls for immediate funding and policy changes to protect vital biodiversity habitats.",
    "Leading electric vehicle manufacturers introduced solid-state battery technology, promising double the range and significantly faster charging times than current lithium-ion power cells.",
    "The world chess championship concluded with a surprising victory by a young challenger, marking a generational shift in dominance within the highly strategic and competitive sport.",
    "Disputes over water rights intensified in several border regions following a year of severe drought, pushing diplomatic efforts to secure sustainable resource management agreements between neighboring countries.",
    "Cryptocurrency adoption surged in developing economies, driven by rising inflation and a search for stable alternative investment and remittance methods among young entrepreneurs.",
    "A collaborative scientific mission confirmed the existence of sub-glacial lakes on Mars, suggesting potential pockets of liquid water that could harbor microbial life or provide future resources.",
    "Local governments are experimenting with four-day work weeks for public sector employees, aiming to boost productivity, improve employee well-being, and reduce urban commuting traffic congestion.",
    "The entertainment industry is grappling with the rapid integration of advanced generative AI tools, raising complex questions about intellectual property, authorship, and the future role of human artists.",
    "Major railway networks announced significant investments in hyperloop technology research, aiming to connect major metropolitan hubs with ultra-high-speed transit systems within the next decade.",
    "New studies indicate that consumption of processed foods contributes more significantly to global health crises than previously estimated, prompting revised dietary guidelines and public health campaigns.",
    "Political tensions escalated in a key maritime trade route after an incident involving naval vessels, leading to emergency diplomatic talks focused on maintaining freedom of navigation and regional stability.",
    "Innovative vertical farming techniques utilizing LED lighting and controlled environments are being adopted by major cities to secure local, year-round fresh produce supply and minimize transport costs.",
    "The global effort to combat vaccine-resistant diseases received a boost with the discovery of a new class of antibiotics derived from rare soil microorganisms found in remote mountainous regions."
];
 // Use this to cycle through the paragraphs sequentially or randomly.


        // --- Chart Setup ---
        const ctx = document.getElementById('wpm-chart').getContext('2d');
        const wpmChart = new Chart(ctx, {
            type: 'line',
            data: { labels: [], datasets: [{ label: 'Net WPM', data: [], borderColor: '#007bff', backgroundColor: '#007bff40', borderWidth: 2, tension: 0.4, fill: true }] },
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: { y: { beginAtZero: true, title: { display: true, text: 'WPM' } }, x: { title: { display: true, text: '' } } },
                plugins: { legend: { display: false } }
            }
        });

        // --- Core Functions ---



        async function loadText() {
            const mode = modeSelect.value;
            let content;

            if (mode === 'news') {
            let currentIndex = parseInt(localStorage.getItem('newsIndex')) || 0;
                content = newsBank[currentIndex % newsBank.length];
                let nextIndex = (currentIndex + 1) % newsBank.length;
                localStorage.setItem('newsIndex', nextIndex);
            } else {
                content = textBank[mode];
            }

            state.testText = content;
            textDisplay.innerHTML = '';
            state.testText.split('').forEach((char, index) => {
                const charSpan = document.createElement('span');
                charSpan.textContent = char;
                if (index === 0) {
                    charSpan.classList.add('current');
                }
                textDisplay.appendChild(charSpan);
            });
        }

        function updateMetrics() {
            state.timeElapsed = state.initialTime - state.timeLeft;
            const timeInMinutes = state.timeElapsed / 60;

            const totalKeystrokes = state.correctKeystrokes + state.incorrectKeystrokes;

            let netWPM = ((state.correctKeystrokes / 5) - state.totalErrors) / timeInMinutes;
            if (netWPM < 0 || timeInMinutes === 0) {
                netWPM = 0;
            }

            let accuracy = (totalKeystrokes > 0) ? (state.correctKeystrokes / totalKeystrokes) * 100 : 100;

            // Update Display
            netWpmEl.textContent = Math.round(netWPM);
            accuracyEl.textContent = Math.round(accuracy);
            errorsCountEl.textContent = state.totalErrors;

            // Chart Update (Every 5 seconds)
            if (state.timeElapsed % 5 === 0 && state.timeElapsed > 0 && state.timeLeft > 0) {
                state.wpmHistory.push(Math.round(netWPM));
                state.historyLabels.push(state.timeElapsed);

                wpmChart.data.labels = state.historyLabels;
                wpmChart.data.datasets[0].data = state.wpmHistory;
                wpmChart.update();
            }
        }

        function updateTimer() {
            if (state.timeLeft > 0) {
                state.timeLeft--;
                timeLeftEl.textContent = state.timeLeft;
                updateMetrics();
            } else {
                clearInterval(state.timerId);
                state.isRunning = false;
                updateMetrics();
                showResultsPopup(); // Show the new results pop-up
            }
        }

        function startTest() {
            if (state.isRunning) return;

            popupOverlay.style.display = 'none'; // Hide pop-up
            state.isRunning = true;
            textInput.disabled = false;
            textInput.focus();

            // Start Timer
            state.timerId = setInterval(updateTimer, 1000);
        }

        function handleInput(event) {
            if (!state.isRunning) return; // Ignore input if not running

            const typedValue = textInput.value;
            const currentTypedChar = typedValue[typedValue.length - 1];
            const targetChar = state.testText[state.currentCharIndex];
            const textSpans = textDisplay.querySelectorAll('span');

            if (event.inputType === 'deleteContentBackward') {
                if (state.currentCharIndex > 0) {
                    state.currentCharIndex--;
                    textSpans[state.currentCharIndex].classList.remove('correct', 'incorrect');
                    textSpans[state.currentCharIndex].classList.add('current');
                    if (textSpans[state.currentCharIndex + 1]) {
                        textSpans[state.currentCharIndex + 1].classList.remove('current');
                    }
                }
                return;
            }

            if (state.currentCharIndex >= state.testText.length) {
                return;
            }

            textSpans[state.currentCharIndex].classList.remove('current');

            if (currentTypedChar === targetChar) {
                textSpans[state.currentCharIndex].classList.add('correct');
                state.correctKeystrokes++;
            } else {
                textSpans[state.currentCharIndex].classList.add('incorrect');
                state.incorrectKeystrokes++;
                state.totalErrors++;
            }

            state.currentCharIndex++;

            if (state.currentCharIndex === state.testText.length) {
                state.timeLeft = 0;
                updateTimer();
                return;
            }

            if (textSpans[state.currentCharIndex]) {
                textSpans[state.currentCharIndex].classList.add('current');
            }
        }

        // --- Pop-up Logic ---

     function showResultsPopup() {
    // Apne pasand ki image ka URL yahan set karein
    const BACKGROUND_IMAGE_URL = 'Time.png'; // Example URL

    const finalWPM = netWpmEl.textContent;
    const finalAccuracy = accuracyEl.textContent;

    // Poora content template naye style aur positioning ke saath
    popupContent.innerHTML = `

        <div id="result-background" style="
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('${BACKGROUND_IMAGE_URL}'); /* Image URL use kiya */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0.8; /* Image ko halka karne ke liye */
            z-index: 5; /* Background ko content se peeche rakhne ke liye */
        "></div>

        <div style="position: relative; z-index: 10; width: 100%; height: 100%; color: #333; padding: 10px;">



            <div class="result-stats" style="
                position: absolute;
                background-color: white;
                border: 3px solid;
                border-color:#129612;
                border-radius:15px;
                bottom: 6%;
                right: 10%;
                font-size: 1.2em;
                text-align: center;
                width: 25%;
            ">
                <p style="margin: 5px 0;">Net WPM: <span style="font-weight: 700; color: #5cb85c;">${finalWPM}</span></p>
                <p style="margin: 5px 0;">Accuracy: <span style="font-weight: 700; color: #5cb85c;">${finalAccuracy}%</span></p>
                <p style="margin: 5px 0;">Total Errors: <span style="font-weight: 700; color: #d9534f;">${errorsCountEl.textContent}</span></p>
            </div>

            <div class="popup-controls" style="
                position: absolute;
                bottom: 8%;
                // width: 30%;
                left: 20%;
                transform: translateX(-50%); /* Center horizontally */
            ">
                <button style="color:#14FF99; background-color:#129612;" onclick="startCountdown()">Restart Test</button>
                <div class="popup-time-select" style="border:3px solid #129612; border-radius: 10px; overflow:hidden;" >
                    <select id="popup-time-select">
                        <option value="60">1 Min</option>
                        <option value="180">3 Mins</option>
                        <option value="300">5 Mins</option>
                    </select>
                    <input type="number" id="popup-custom-time" min="10" max="600" value="${state.initialTime}" placeholder="Custom (s)">
                </div>
            </div>

        </div>
    `;

    // Ensure the overall pop-up container (popupContent) is correctly sized and positioned relative to body.
    // Aapko apni CSS file mein .popup-content ko manually adjust karna padega.
    // Recommended CSS adjustments (Agar yeh aapke main CSS mein nahi hain):
    /*
    .popup-content {
        position: relative;
        width: 450px;
        height: 350px;
        padding: 0;
        background-color: white; /* Ya jo bhi aap chahte hain *
    }
    */

    // Sync time options to the popup
    document.getElementById('popup-time-select').value = state.initialTime;
    document.getElementById('popup-custom-time').value = state.initialTime;

    popupOverlay.style.display = 'flex';
    popupContent.classList.add('show');

    // Attach listeners to popup controls
    document.getElementById('popup-time-select').addEventListener('change', syncTimeAndReset);
    document.getElementById('popup-custom-time').addEventListener('change', syncTimeAndReset);
}

        function startCountdown() {
            let count = 3;
            popupContent.innerHTML = `<div class="countdown-number">${count}</div>`;
            popupOverlay.style.display = 'flex';
            popupContent.classList.add('show');

            const countdownInterval = setInterval(() => {
                count--;
                if (count > 0) {
                    popupContent.innerHTML = `<div class="countdown-number">${count}</div>`;
                } else if (count === 0) {
                    popupContent.innerHTML = `<div class="countdown-number">GO!</div>`;
                } else {
                    clearInterval(countdownInterval);
                    startTest();
                }
            }, 1000);
        }

        // --- Reset Logic (Called by all controls) ---

        function syncTimeAndReset() {
             // Get time from pop-up or initial control
            let newTimeEl = document.getElementById('popup-custom-time') || customTimeInput;
            let selectEl = document.getElementById('popup-time-select') || timeSelect;

            let newTime = parseInt(selectEl.value);

            // If custom time input has a value, override the select value
            if (newTimeEl.value) {
                newTime = parseInt(newTimeEl.value);
            }

            if (isNaN(newTime) || newTime < 10) newTime = 60;

            // Update both main and popup/initial controls to reflect the change
            timeSelect.value = newTime;
            customTimeInput.value = newTime;
            if (document.getElementById('popup-time-select')) {
                 document.getElementById('popup-time-select').value = newTime;
                 document.getElementById('popup-custom-time').value = newTime;
            }

            resetTest(newTime);
        }

        function resetTest(newTime) {
            clearInterval(state.timerId);

            const timeToSet = newTime || state.initialTime; // Use newTime if provided

            // Reset state
            state = {
                testText: state.testText,
                currentCharIndex: 0,
                totalErrors: 0,
                correctKeystrokes: 0,
                incorrectKeystrokes: 0,
                timerId: null,
                initialTime: timeToSet,
                timeLeft: timeToSet,
                isRunning: false,
                wpmHistory: [],
                historyLabels: [],
                timeElapsed: 0,
            };

            // Reset DOM
            textInput.value = '';
            textInput.disabled = true; // Disable input until countdown starts
            timeLeftEl.textContent = state.initialTime;
            netWpmEl.textContent = '0';
            accuracyEl.textContent = '100';
            errorsCountEl.textContent = '0';

            // Reset Chart
            wpmChart.data.labels = [];
            wpmChart.data.datasets[0].data = [];
            wpmChart.update();

            popupOverlay.style.display = 'none'; // Hide pop-up if visible

            loadText(); // Load new text based on mode
        }

        // --- Event Listeners ---
        textInput.addEventListener('input', handleInput);

        // Initial start button
        initialStartBtn.addEventListener('click', () => {
             syncTimeAndReset(); // Ensure time is synced and content is loaded
             startCountdown();
        });

        // Controls (Mode/Time change only loads content/sets time, does not start)
        modeSelect.addEventListener('change', syncTimeAndReset);
        timeSelect.addEventListener('change', syncTimeAndReset);
        customTimeInput.addEventListener('change', syncTimeAndReset);

        // --- Initial Setup ---
        syncTimeAndReset();
    </script>
</body>
</html>
